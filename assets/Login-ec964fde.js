import{r as l,A as F,j as a,l as L}from"./index-af1d8954.js";import{r as T}from"./react-router-dom.min-170b0db9.js";import{u as D,W as I,r}from"./http-hooks-95b67396.js";import{u,c as g,a as A,b as n,I as x}from"./Input-421ca7c9.js";import"./tiny-invariant-153ae361.js";import"./tiny-warning.esm-d436548b.js";const $=()=>{const m=T.useHistory(),d=l.useContext(F),[c,v]=l.useState(!1),[f,i]=l.useState(!1),[w,y]=l.useState(""),[j,b]=l.useState(""),{isLoading:S,error:N,sendRequest:p,clearError:C}=D(),s=u({initialValues:{photo:"",name:"",email:"",password:""},validationSchema:g({photo:A().required("Please upload an image"),name:n().required("name is required"),email:n().required("email is required").email("Not a proper email"),password:n().required("password is required").min(6,"password must be 6 characters long")}),onSubmit:async()=>{try{const e=new FormData;e.append("name",s.values.name),e.append("email",s.values.email),e.append("password",s.values.password),e.append("image",w);const t=await p("https://mern-practice-be-wwsf.onrender.com/api/users/signup","POST",e);d.login(t.userId,t.token),m.push("/")}catch(e){console.log(e),i(!0)}s.values.photo=""}}),o=u({initialValues:{email:"",password:""},validationSchema:g({email:n().required("email is required").email("Not a proper email"),password:n().required("password is required")}),onSubmit:async()=>{try{const e=await p("https://mern-practice-be-wwsf.onrender.com/api/users/login","POST",JSON.stringify({email:o.values.email,password:o.values.password}),{"Content-Type":"application/json"});d.login(e.userId,e.token),m.push("/")}catch(e){console.log(e),i(!0)}o.resetForm()}}),P=e=>{s.handleChange(e),y(e.target.files[0]);const t=new FileReader;t.onload=()=>{b(t.result)},t.readAsDataURL(e.target.files[0]||"")},k=[{name:"photo",label:"Photo",type:"file",touched:s.touched.photo,error:s.errors.photo,value:s.values.photo,onChangePhoto:P},{name:"name",label:"Name",type:"text",touched:s.touched.name,error:s.errors.name,value:s.values.name},{name:"email",label:"Email",type:"email",touched:s.touched.email,error:s.errors.email,value:s.values.email},{name:"password",label:"Password",type:"password",touched:s.touched.password,error:s.errors.password,value:s.values.password}],q=[{name:"email",label:"Email",type:"email",touched:o.touched.email,error:o.errors.email,value:o.values.email},{name:"password",label:"Password",type:"password",touched:o.touched.password,error:o.errors.password,value:o.values.password}],h=()=>{v(e=>!e),s.values.photo=""},U=()=>{i(e=>!e)};return a.jsxs("div",{className:"flex justify-center items-center h-screen mt-[-65px]",children:[a.jsx(I,{toogleModal:U,openModal:f,message:N,onClear:C}),a.jsxs(r.Card,{className:"w-96",children:[a.jsx(r.CardHeader,{variant:"gradient",color:"gray",className:"mb-4 grid h-28 place-items-center",children:a.jsxs(r.Typography,{variant:"h3",color:"white",className:"flex gap-2 items-center",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})}),c?"Sign Up":"Login"]})}),S?a.jsx(r.CardBody,{className:"flex justify-center",children:a.jsx("img",{className:"w-[150px]",src:L,alt:"loading"})}):c?a.jsxs("form",{onSubmit:s.handleSubmit,children:[a.jsxs(r.CardBody,{className:"flex flex-col gap-4",children:[s.values.photo&&a.jsx("div",{className:"flex justify-center",children:a.jsx("img",{className:"w-[150px] h-[150px] object-cover rounded-lg mb-5",src:j,alt:""})}),k.map(e=>a.jsx(x,{formik:s,id:e.name,name:e.name,label:e.label,type:e.type,touched:e.touched,error:e.error,value:e.value,onChangePhoto:e.onChangePhoto},e.name))]}),a.jsxs(r.CardFooter,{className:"pt-0",children:[a.jsx(r.Button,{type:"submit",variant:"gradient",fullWidth:!0,children:"Sign Up"}),a.jsxs(r.Typography,{variant:"small",className:"mt-6 flex justify-center",children:["Already have account?",a.jsx(r.Typography,{as:"a",href:"#signup",variant:"small",color:"blue-gray",className:"ml-1 font-bold",children:a.jsx("span",{onClick:h,children:"login"})})]})]})]}):a.jsxs("form",{onSubmit:o.handleSubmit,children:[a.jsx(r.CardBody,{className:"flex flex-col gap-4",children:q.map(e=>a.jsx(x,{formik:o,id:e.name,name:e.name,label:e.label,type:e.type,touched:e.touched,error:e.error,value:e.value},e.name))}),a.jsxs(r.CardFooter,{className:"pt-0",children:[a.jsx(r.Button,{type:"submit",variant:"gradient",fullWidth:!0,children:"Login"}),a.jsxs(r.Typography,{variant:"small",className:"mt-6 flex justify-center",children:["Dont have an account?",a.jsx(r.Typography,{as:"a",href:"#signup",variant:"small",color:"blue-gray",className:"ml-1 font-bold",children:a.jsx("span",{onClick:h,children:"Sign Up"})})]})]})]})]})]})};export{$ as default};
