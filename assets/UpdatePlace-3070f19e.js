import{r as i,A as w,u as C,c as v,j as t,l as N}from"./index-af1d8954.js";import{u as A,c as I,b as p,I as S}from"./Input-421ca7c9.js";import{u as T,r,W as $}from"./http-hooks-95b67396.js";import"./tiny-warning.esm-d436548b.js";const F=()=>{const u=i.useContext(w),x=C(),{isLoading:o,error:h,sendRequest:c,clearError:f}=T(),n=v().placeId,[s,j]=i.useState({}),[y,d]=i.useState(!1);i.useEffect(()=>{(async()=>{try{const m=await c(`https://mern-practice-be-wwsf.onrender.com/api/places/${n}`);j(m.place)}catch(m){console.log(m),d(!0)}})()},[n,c]);const e=A({enableReinitialize:!0,initialValues:{title:(s==null?void 0:s.title)||"",description:(s==null?void 0:s.description)||""},validationSchema:I({title:p().min(6,"Must be at least 6 character").required("Please enter valid title"),description:p().min(10,"Must be at least 10 character").required("Please enter valid description")}),onSubmit:async()=>{try{await c(`https://mern-practice-be-wwsf.onrender.com/api/places/${n}`,"PATCH",JSON.stringify({title:e.values.title,description:e.values.description}),{"Content-Type":"application/json",Authorization:"Bearer "+u.token}),x.push(`/${u.userId}/places`)}catch(a){console.log(a),d(!0)}}}),b=[{name:"title",label:"Title",type:"title",touched:e.touched.title,error:e.errors.title,value:e.values.title,isTextArea:!1},{name:"description",label:"Description",type:"description",touched:e.touched.description,error:e.errors.description,value:e.values.description,isTextArea:!0}],g=()=>{d(a=>!a)};let l;return o&&(l=t.jsx(r.Card,{className:"w-[90%] md:w-[50%]",children:t.jsx(r.CardBody,{className:"flex justify-center",children:t.jsx("img",{className:"w-[150px]",src:N,alt:"loading"})})})),!o&&!s&&(l=t.jsx(r.Card,{className:"w-[90%] md:w-[50%]",children:t.jsx(r.CardBody,{className:"text-center",children:"Could not find place"})})),!o&&s&&(l=t.jsx(r.Card,{className:"w-[90%] md:w-[50%]",children:t.jsxs("form",{onSubmit:e.handleSubmit,children:[t.jsx(r.CardBody,{className:"flex flex-col gap-5 py-10",children:b.map(a=>t.jsx(S,{formik:e,id:a.name,name:a.name,label:a.label,touched:a.touched,error:a.error,value:a.value,isTextArea:a.isTextArea},a.name))}),t.jsx(r.CardFooter,{className:"text-right",children:t.jsx(r.Button,{disabled:!(e.isValid&&e.dirty),color:e.isValid&&e.dirty?"blue":"red",className:e.isValid&&e.dirty?"cursor-pointer":"cursor-not-allowed",type:"submit",children:"Udate Place"})})]})})),t.jsxs(t.Fragment,{children:[t.jsx($,{toogleModal:g,openModal:y,message:h,onClear:f}),t.jsx("div",{className:"flex justify-center",children:l}),";"]})};export{F as default};
